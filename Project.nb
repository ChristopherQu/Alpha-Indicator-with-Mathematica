(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28248,        716]
NotebookOptionsPosition[     27847,        699]
NotebookOutlinePosition[     28221,        715]
CellTagsIndexPosition[     28178,        712]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"First", " ", "Step"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", "13"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"a", "[", "i", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<C:\\Users\\quhui\\Desktop\\ROE.xlsx\>\"", ",", 
           "\"\<Data\>\""}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Off", "[", 
    RowBox[{"Syntax", "::", "stresc"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "12"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"a", "[", "i", "]"}], "/=", "12"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TTMROE", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AIRT", ",", 
         RowBox[{"a", "[", "1", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ATSG", ",", 
         RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"AAWW", ",", 
         RowBox[{"a", "[", "3", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CHRW", ",", 
         RowBox[{"a", "[", "4", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DSX", ",", 
         RowBox[{"a", "[", "5", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"EXPD", ",", 
         RowBox[{"a", "[", "6", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"FDX", ",", 
         RowBox[{"a", "[", "7", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"FWRD", ",", 
         RowBox[{"a", "[", "8", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"HUBG", ",", 
         RowBox[{"a", "[", "9", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"RLGT", ",", 
         RowBox[{"a", "[", "10", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"RRTS", ",", 
         RowBox[{"a", "[", "11", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"UPS", ",", 
         RowBox[{"a", "[", "12", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "Step"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", "13"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"b", "[", "i", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<C:\\Users\\quhui\\Desktop\\ROE.xlsx\>\"", ",", 
           "\"\<Data\>\""}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "12"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"b", "[", "i", "]"}], "/=", "12"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LASTROE", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AIRT", ",", 
         RowBox[{"b", "[", "1", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ATSG", ",", 
         RowBox[{"b", "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"AAWW", ",", 
         RowBox[{"b", "[", "3", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CHRW", ",", 
         RowBox[{"b", "[", "4", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DSX", ",", 
         RowBox[{"b", "[", "5", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"EXPD", ",", 
         RowBox[{"b", "[", "6", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"FDX", ",", 
         RowBox[{"b", "[", "7", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"FWRD", ",", 
         RowBox[{"b", "[", "8", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"HUBG", ",", 
         RowBox[{"b", "[", "9", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"RLGT", ",", 
         RowBox[{"b", "[", "10", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"RRTS", ",", 
         RowBox[{"b", "[", "11", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"UPS", ",", 
         RowBox[{"b", "[", "12", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rLASTROE", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"SortBy", "[", 
       RowBox[{"LASTROE", ",", "Last"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", "12"}], ",", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{
      RowBox[{"TTMROE", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "2"}], "]"}], "]"}], "-=", 
      RowBox[{"LASTROE", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"RANKofBEST", "=", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"SortBy", "[", 
       RowBox[{"TTMROE", ",", "Last"}], "]"}], "]"}], "//", 
     "MatrixForm"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7354024181095796`*^9, 3.735402426487204*^9}, {
   3.735402487882079*^9, 3.7354025244621572`*^9}, {3.7354027086669674`*^9, 
   3.7354029950010223`*^9}, {3.7354041045068207`*^9, 3.735404110836646*^9}, {
   3.7354041734330273`*^9, 3.7354041846538825`*^9}, {3.735404237604598*^9, 
   3.7354043028509207`*^9}, {3.7354045613576746`*^9, 3.735404622669637*^9}, {
   3.7354046981111603`*^9, 3.7354048098829155`*^9}, {3.7354050172055035`*^9, 
   3.735405064204423*^9}, {3.7354052465276737`*^9, 3.7354052564029264`*^9}, 
   3.7354055945183067`*^9, {3.735405714592169*^9, 3.7354057378131695`*^9}, {
   3.735405848944874*^9, 3.7354058596072826`*^9}, {3.7354686166475554`*^9, 
   3.7354686336011114`*^9}, {3.735468902786422*^9, 3.735468930934054*^9}, {
   3.735469158476564*^9, 3.7354691620894995`*^9}, {3.735469194189835*^9, 
   3.735469197161395*^9}, 3.735511762420601*^9, 3.7355118289241934`*^9, 
   3.735512019123415*^9, {3.7355121175412135`*^9, 3.7355121294060235`*^9}, {
   3.7355123027619095`*^9, 3.735512314892782*^9}, {3.7355126647856684`*^9, 
   3.735512678496222*^9}, 3.735514158327963*^9, 3.7355143926252007`*^9, 
   3.7355166120510054`*^9, {3.7355168253608713`*^9, 3.7355168451715894`*^9}, {
   3.735516917951995*^9, 3.735516922278628*^9}, {3.735516957908605*^9, 
   3.735516962035681*^9}, {3.735517079118105*^9, 3.735517083607768*^9}, {
   3.73551712413415*^9, 3.73551715945024*^9}, {3.7355174572817965`*^9, 
   3.7355174688015804`*^9}, {3.735517509362686*^9, 3.7355175111753445`*^9}, 
   3.7355574467590637`*^9, 3.735559714363396*^9, 3.735562633604768*^9, {
   3.735664420663965*^9, 3.735664500528372*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Test", " ", "if", " ", "the", " ", "top", " ", "20", "%", " ", "stocks", 
    " ", "outperform", " ", "the", " ", "market"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"m", "=", "1"}], ",", 
      RowBox[{"m", "\[LessEqual]", "12"}], ",", 
      RowBox[{"m", "++"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TTMROE", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "1"}], "]"}], "]"}], "\[NotEqual]", "UPS"}], "&&",
           "RRTS", "&&", "AIRT", "&&", "FWRD"}], ",", 
         RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
       RowBox[{"R", "=", 
        RowBox[{"R", "+", 
         RowBox[{"TTMROE", "[", 
          RowBox[{"[", 
           RowBox[{"m", ",", "2"}], "]"}], "]"}]}]}]}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"k", "=", "1"}], ",", 
      RowBox[{"k", "\[LessEqual]", "12"}], ",", 
      RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mkt", "[", "k", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
          "\"\<C:\\Users\\quhui\\Desktop\\ROE.xlsx\>\"", ",", 
           "\"\<Data\>\""}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"k", "+", "1"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MKT", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"mkt", ",", "12"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MEAN", "=", 
     RowBox[{"Mean", "[", "MKT", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RESULT", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"R", "\[GreaterEqual]", "MEAN"}], ",", 
       "\"\<Top 25% outperform the market\>\"", ",", 
       "\"\<Top 25% underperform the market\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "RESULT", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7355129373026934`*^9, 3.7355130743624363`*^9}, {
   3.73551324296926*^9, 3.735513246800145*^9}, {3.735513324058256*^9, 
   3.735513326709119*^9}, {3.73551346858422*^9, 3.735513474464323*^9}, {
   3.7355135800656013`*^9, 3.7355136072342224`*^9}, {3.73551364123315*^9, 
   3.7355137302794914`*^9}, {3.73551378313556*^9, 3.7355137980941253`*^9}, {
   3.735513993367419*^9, 3.7355140515437355`*^9}, {3.7355142315128956`*^9, 
   3.7355142442453785`*^9}, {3.7355143321731524`*^9, 3.735514348112725*^9}, 
   3.7355164354084916`*^9, 3.73551647306808*^9, 3.7355165071333027`*^9, {
   3.7355165428509274`*^9, 3.7355165657048798`*^9}, {3.7355167459872675`*^9, 
   3.735516755762045*^9}, {3.7355559189306417`*^9, 3.7355559329124413`*^9}, {
   3.7355571040110755`*^9, 3.735557143166844*^9}, {3.7355572093155155`*^9, 
   3.735557247490386*^9}, {3.73555728116082*^9, 3.7355572825671864`*^9}, {
   3.735557320330205*^9, 3.735557329890744*^9}, {3.7355574147652473`*^9, 
   3.735557419680155*^9}, 3.7355585014979305`*^9, {3.735558540954197*^9, 
   3.7355585672822266`*^9}, {3.735558938375106*^9, 3.7355589487837725`*^9}, {
   3.735559239820631*^9, 3.7355592428158875`*^9}, {3.735560322291893*^9, 
   3.7355603268873367`*^9}, {3.735560948757076*^9, 3.7355609729483194`*^9}, {
   3.735561527944853*^9, 3.735561626553359*^9}, {3.7355618953350945`*^9, 
   3.7355619348369102`*^9}, {3.7355620033989754`*^9, 3.735562004495*^9}, {
   3.735562037774705*^9, 3.7355621743047514`*^9}, {3.73556221168406*^9, 
   3.7355622692990217`*^9}, {3.73556254281411*^9, 3.735562545379122*^9}, {
   3.735562585147708*^9, 3.735562646563236*^9}, {3.735664532390048*^9, 
   3.735664565112059*^9}, {3.735932122864051*^9, 3.73593212416852*^9}, {
   3.736073861722497*^9, 3.7360738683648243`*^9}, 3.7360740715738773`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Back", "-", "testing"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "465"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"a", "[", "i", "]"}], "=", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
         "\"\<C:\\Users\\quhui\\Desktop\\S&P 500.xlsx\>\"", ",", 
          "\"\<Data\>\""}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BT", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", "465"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", "465"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"BT", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], "/=", "12"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rBT16", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"SortBy", "[", 
       RowBox[{"BT", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", "465"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"BT", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], "/=", "12"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rBT17", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"SortBy", "[", 
       RowBox[{"BT", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "&"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", "465"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"BT", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], "-=", 
       RowBox[{"BT", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RESULT", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"SortBy", "[", 
       RowBox[{"BT", ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "&"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"RESULT", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", 
         RowBox[{"Round", "[", 
          RowBox[{"0.25", "*", "466"}], "]"}]}], ",", "1"}], "]"}], "]"}], 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Round", "[", 
        RowBox[{"0.25", "*", "466"}], "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"NAME", "[", "i", "]"}], "=", 
       RowBox[{"RESULT", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7356620885259824`*^9, 3.7356622049234486`*^9}, {
   3.735662251644808*^9, 3.7356622629167814`*^9}, {3.7356623371551847`*^9, 
   3.735662366705758*^9}, {3.735662459834038*^9, 3.7356624641926193`*^9}, 
   3.7356625095702825`*^9, {3.735663329321026*^9, 3.7356633820081687`*^9}, 
   3.735663415317694*^9, {3.735663536007661*^9, 3.7356635670993357`*^9}, {
   3.7356636259428*^9, 3.7356636753602023`*^9}, {3.7356637878914804`*^9, 
   3.735663789207981*^9}, {3.7356638438171883`*^9, 3.735663844337584*^9}, {
   3.7356639396420274`*^9, 3.7356639437379203`*^9}, {3.7356640303188567`*^9, 
   3.735664034966215*^9}, {3.735664076772419*^9, 3.7356640792871065`*^9}, {
   3.7356641948343506`*^9, 3.735664200568638*^9}, {3.7356643040488577`*^9, 
   3.7356643093228817`*^9}, 3.73566437902322*^9, {3.7356646163329134`*^9, 
   3.735664619902454*^9}, {3.735740349818015*^9, 3.7357404599086742`*^9}, 
   3.735740586469675*^9, 3.735740689513075*^9, {3.735740747829129*^9, 
   3.7357407616413255`*^9}, {3.7357408994785066`*^9, 3.735740900077179*^9}, {
   3.735741068873665*^9, 3.735741072138973*^9}, {3.7359365735444455`*^9, 
   3.735936576035041*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Return", " ", "of", " ", "Portfolio"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Round", "[", 
        RowBox[{"0.25", "*", "466"}], "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EARN", "[", "i", "]"}], "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"NAME", "[", "i", "]"}], "==", "\"\<AMD\>\""}], ",", 
         RowBox[{"FinancialData", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<NASDAQ:\>\"", ",", 
             RowBox[{"NAME", "[", "i", "]"}]}], "]"}], ",", 
           "\"\<EarningsPerShare\>\""}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NAME", "[", "i", "]"}], "==", "\"\<COP\>\""}], ",", 
         RowBox[{"FinancialData", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<NYSE:\>\"", ",", 
             RowBox[{"NAME", "[", "i", "]"}]}], "]"}], ",", 
           "\"\<EarningsPerShare\>\""}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"NAME", "[", "i", "]"}], "\[NotEqual]", " ", 
           "\"\<AMD\>\""}], "&&", 
          RowBox[{
           RowBox[{"NAME", "[", "i", "]"}], "\[NotEqual]", "\"\<COP\>\""}]}], 
         ",", 
         RowBox[{"FinancialData", "[", 
          RowBox[{
           RowBox[{"NAME", "[", "i", "]"}], ",", "\"\<EarningsPerShare\>\""}],
           "]"}]}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"PORT", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"EARN", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Round", "[", 
         RowBox[{"0.25", "*", "466"}], "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"PORT", ">", "109.88"}], ",", 
     RowBox[{"Print", "[", "\"\<Outperformance\>\"", "]"}], ",", 
     RowBox[{"Print", "[", "\"\<Underperformance\>\"", "]"}]}], "]"}], "\n", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"m", "=", "1"}], ",", 
     RowBox[{"m", "\[LessEqual]", 
      RowBox[{"Round", "[", 
       RowBox[{"0.25", "*", "466"}], "]"}]}], ",", 
     RowBox[{"m", "++"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "m", "]"}], "=", 
      RowBox[{"DateListPlot", "[", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"NAME", "[", "m", "]"}], "==", "\"\<AMD\>\""}], ",", 
         RowBox[{"FinancialData", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<NASDAQ:\>\"", ",", 
             RowBox[{"NAME", "[", "m", "]"}]}], "]"}], ",", 
           "\"\<CumulativeFractionalChange\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"2017", ",", "5", ",", "18"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NAME", "[", "m", "]"}], "==", "\"\<COP\>\""}], ",", 
         RowBox[{"FinancialData", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<NYSE:\>\"", ",", 
             RowBox[{"NAME", "[", "m", "]"}]}], "]"}], ",", 
           "\"\<CumulativeFractionalChange\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"2017", ",", "5", ",", "18"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"NAME", "[", "m", "]"}], "\[NotEqual]", " ", 
           "\"\<AMD\>\""}], "&&", 
          RowBox[{
           RowBox[{"NAME", "[", "m", "]"}], "\[NotEqual]", "\"\<COP\>\""}]}], 
         ",", 
         RowBox[{"FinancialData", "[", 
          RowBox[{
           RowBox[{"NAME", "[", "m", "]"}], ",", 
           "\"\<CumulativeFractionalChange\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"2017", ",", "5", ",", "18"}], "}"}]}], "]"}]}], "]"}], 
       "]"}]}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "117", "]"}], "=", 
     RowBox[{"DateListPlot", "[", 
      RowBox[{
       RowBox[{"FinancialData", "[", 
        RowBox[{
        "\"\<SP500\>\"", ",", "\"\<CumulativeFractionalChange\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"2017", ",", "5", ",", "18"}], "}"}]}], "]"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"p", "[", "4", "]"}], ",", 
     RowBox[{"p", "[", "5", "]"}], ",", 
     RowBox[{"p", "[", "6", "]"}], ",", 
     RowBox[{"p", "[", "7", "]"}], ",", 
     RowBox[{"p", "[", "8", "]"}], ",", 
     RowBox[{"p", "[", "9", "]"}], ",", 
     RowBox[{"p", "[", "10", "]"}], ",", 
     RowBox[{"p", "[", "11", "]"}], ",", 
     RowBox[{"p", "[", "12", "]"}], ",", 
     RowBox[{"p", "[", "13", "]"}], ",", 
     RowBox[{"p", "[", "14", "]"}], ",", 
     RowBox[{"p", "[", "15", "]"}], ",", 
     RowBox[{"p", "[", "16", "]"}], ",", 
     RowBox[{"p", "[", "17", "]"}], ",", 
     RowBox[{"p", "[", "18", "]"}], ",", 
     RowBox[{"p", "[", "19", "]"}], ",", 
     RowBox[{"p", "[", "20", "]"}], ",", 
     RowBox[{"p", "[", "21", "]"}], ",", 
     RowBox[{"p", "[", "22", "]"}], ",", 
     RowBox[{"p", "[", "23", "]"}], ",", 
     RowBox[{"p", "[", "24", "]"}], ",", 
     RowBox[{"p", "[", "25", "]"}], ",", 
     RowBox[{"p", "[", "26", "]"}], ",", 
     RowBox[{"p", "[", "27", "]"}], ",", 
     RowBox[{"p", "[", "28", "]"}], ",", 
     RowBox[{"p", "[", "29", "]"}], ",", 
     RowBox[{"p", "[", "30", "]"}], ",", 
     RowBox[{"p", "[", "31", "]"}], ",", 
     RowBox[{"p", "[", "32", "]"}], ",", 
     RowBox[{"p", "[", "33", "]"}], ",", 
     RowBox[{"p", "[", "34", "]"}], ",", 
     RowBox[{"p", "[", "35", "]"}], ",", 
     RowBox[{"p", "[", "36", "]"}], ",", 
     RowBox[{"p", "[", "37", "]"}], ",", 
     RowBox[{"p", "[", "38", "]"}], ",", 
     RowBox[{"p", "[", "39", "]"}], ",", 
     RowBox[{"p", "[", "40", "]"}], ",", 
     RowBox[{"p", "[", "41", "]"}], ",", 
     RowBox[{"p", "[", "42", "]"}], ",", 
     RowBox[{"p", "[", "43", "]"}], ",", 
     RowBox[{"p", "[", "44", "]"}], ",", 
     RowBox[{"p", "[", "45", "]"}], ",", 
     RowBox[{"p", "[", "46", "]"}], ",", 
     RowBox[{"p", "[", "47", "]"}], ",", 
     RowBox[{"p", "[", "48", "]"}], ",", 
     RowBox[{"p", "[", "49", "]"}], ",", 
     RowBox[{"p", "[", "50", "]"}], ",", 
     RowBox[{"p", "[", "51", "]"}], ",", 
     RowBox[{"p", "[", "52", "]"}], ",", 
     RowBox[{"p", "[", "53", "]"}], ",", 
     RowBox[{"p", "[", "54", "]"}], ",", 
     RowBox[{"p", "[", "55", "]"}], ",", 
     RowBox[{"p", "[", "56", "]"}], ",", 
     RowBox[{"p", "[", "57", "]"}], ",", 
     RowBox[{"p", "[", "58", "]"}], ",", 
     RowBox[{"p", "[", "59", "]"}], ",", 
     RowBox[{"p", "[", "60", "]"}], ",", 
     RowBox[{"p", "[", "61", "]"}], ",", 
     RowBox[{"p", "[", "62", "]"}], ",", 
     RowBox[{"p", "[", "63", "]"}], ",", 
     RowBox[{"p", "[", "64", "]"}], ",", 
     RowBox[{"p", "[", "65", "]"}], ",", 
     RowBox[{"p", "[", "66", "]"}], ",", 
     RowBox[{"p", "[", "67", "]"}], ",", 
     RowBox[{"p", "[", "68", "]"}], ",", 
     RowBox[{"p", "[", "69", "]"}], ",", 
     RowBox[{"p", "[", "70", "]"}], ",", 
     RowBox[{"p", "[", "71", "]"}], ",", 
     RowBox[{"p", "[", "72", "]"}], ",", 
     RowBox[{"p", "[", "73", "]"}], ",", 
     RowBox[{"p", "[", "74", "]"}], ",", 
     RowBox[{"p", "[", "75", "]"}], ",", 
     RowBox[{"p", "[", "76", "]"}], ",", 
     RowBox[{"p", "[", "77", "]"}], ",", 
     RowBox[{"p", "[", "78", "]"}], ",", 
     RowBox[{"p", "[", "79", "]"}], ",", 
     RowBox[{"p", "[", "80", "]"}], ",", 
     RowBox[{"p", "[", "81", "]"}], ",", 
     RowBox[{"p", "[", "82", "]"}], ",", 
     RowBox[{"p", "[", "83", "]"}], ",", 
     RowBox[{"p", "[", "84", "]"}], ",", 
     RowBox[{"p", "[", "85", "]"}], ",", 
     RowBox[{"p", "[", "86", "]"}], ",", 
     RowBox[{"p", "[", "87", "]"}], ",", 
     RowBox[{"p", "[", "88", "]"}], ",", 
     RowBox[{"p", "[", "89", "]"}], ",", 
     RowBox[{"p", "[", "90", "]"}], ",", 
     RowBox[{"p", "[", "91", "]"}], ",", 
     RowBox[{"p", "[", "92", "]"}], ",", 
     RowBox[{"p", "[", "93", "]"}], ",", 
     RowBox[{"p", "[", "94", "]"}], ",", 
     RowBox[{"p", "[", "95", "]"}], ",", 
     RowBox[{"p", "[", "96", "]"}], ",", 
     RowBox[{"p", "[", "97", "]"}], ",", 
     RowBox[{"p", "[", "98", "]"}], ",", 
     RowBox[{"p", "[", "99", "]"}], ",", 
     RowBox[{"p", "[", "100", "]"}], ",", 
     RowBox[{"p", "[", "101", "]"}], ",", 
     RowBox[{"p", "[", "102", "]"}], ",", 
     RowBox[{"p", "[", "103", "]"}], ",", 
     RowBox[{"p", "[", "104", "]"}], ",", 
     RowBox[{"p", "[", "105", "]"}], ",", 
     RowBox[{"p", "[", "106", "]"}], ",", 
     RowBox[{"p", "[", "107", "]"}], ",", 
     RowBox[{"p", "[", "108", "]"}], ",", 
     RowBox[{"p", "[", "109", "]"}], ",", 
     RowBox[{"p", "[", "110", "]"}], ",", 
     RowBox[{"p", "[", "111", "]"}], ",", 
     RowBox[{"p", "[", "112", "]"}], ",", 
     RowBox[{"p", "[", "113", "]"}], ",", 
     RowBox[{"p", "[", "114", "]"}], ",", 
     RowBox[{"p", "[", "115", "]"}], ",", 
     RowBox[{"p", "[", "116", "]"}], ",", 
     RowBox[{"p", "[", "117", "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.735746222673375*^9, 3.7357463158477993`*^9}, {
   3.7357486743613224`*^9, 3.7357486775607977`*^9}, 3.735924197693609*^9, {
   3.7359242331636295`*^9, 3.7359242360533667`*^9}, {3.735924449350809*^9, 
   3.735924465042035*^9}, {3.735924505318076*^9, 3.735924524334366*^9}, 
   3.735924556208675*^9, {3.7359246462892847`*^9, 3.735924651958849*^9}, {
   3.7359248056296234`*^9, 3.735924822929564*^9}, {3.735925328601248*^9, 
   3.735925352403854*^9}, {3.735925615893651*^9, 3.7359256346826644`*^9}, 
   3.7359257120718746`*^9, 3.73592576500352*^9, {3.7359365862311916`*^9, 
   3.7359365936954827`*^9}, {3.735937394241826*^9, 3.73593739466796*^9}, {
   3.7359374855212016`*^9, 3.735937569934372*^9}, {3.7359378396441917`*^9, 
   3.7359378635819016`*^9}, {3.735937945231371*^9, 3.735937989534259*^9}, {
   3.7359380735743256`*^9, 3.735938102321808*^9}, {3.7359381338045015`*^9, 
   3.735938138402495*^9}, {3.735938218760729*^9, 3.735938220834244*^9}, {
   3.7359383949145355`*^9, 3.735938396896048*^9}, {3.7359384749296036`*^9, 
   3.7359385478049884`*^9}, {3.7359386364316626`*^9, 3.735938665180807*^9}, {
   3.7359387405925045`*^9, 3.735938787179429*^9}, {3.735939102120844*^9, 
   3.7359392753209*^9}, 3.7359393306560583`*^9, {3.7359394438980417`*^9, 
   3.735939464303862*^9}, {3.7359397505653143`*^9, 3.735939763745367*^9}, {
   3.7359413361127367`*^9, 3.735941341208601*^9}, {3.735941877928672*^9, 
   3.7359419349894147`*^9}, {3.7359423710191636`*^9, 3.735942415740841*^9}, {
   3.7359424960831985`*^9, 3.735942498332525*^9}, {3.735942536819943*^9, 
   3.7359425914417915`*^9}, 3.7359426307864747`*^9, {3.735942684833527*^9, 
   3.7359426975035725`*^9}, 3.7360745598408613`*^9, 3.736189797967308*^9, {
   3.73635606994433*^9, 3.736356094502981*^9}}]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>0.9 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7260, 193, 250, "Input"],
Cell[7821, 215, 4035, 89, 190, "Input"],
Cell[11859, 306, 4574, 127, 230, "Input"],
Cell[16436, 435, 11407, 262, 370, "Input"]
}
]
*)

